# 2가지 이상의 조건을 만족시키는 데이터를 조회하고 싶을 때(bool: filter, must)
## ✅ 2가지 이상의 조건을 만족시키는 데이터를 조회하고 싶을 때(bool: filter, must)
2가지 이상의 조건을 만족시키는 쿼리를 작성하려면 `bool 쿼리`를 활용해야 한다. `bool 쿼리`는 크게 4가지 기능이 있다.
* `must`: SQL문에서 `AND` 역할을 함
* `filter`: SQL문에서 `AND` 역할을 함
* `must_not`: SQL문에서 `NOT`역할을 함
* `should`: 조건을 만족하면 좋고, 아니면 말고

```
GET /boards/_search
{
    "query": {
        "bool" : {
            "filter": [
              {
                "term": {
                    "category": "자유 게시판"
                }
              },
              {
                "term": {
                    "board_id": 1
                }
              }
            ]
        }
    }
}

GET /boards/_search
{
    "query": {
        "bool": {
            "must": [
              {
                "term": {
                    "category": "자유 게시판"
                }
              },
              {
                "term": {
                    "board_id": 1
                }
              }
            ]
        }
    }
}
```
위 두 쿼리를 실행시켜보면 정상적으로 원하는 데이터를 잘 불러오는 것처럼 보이지만, `must`는 용도에 맞지 않게 잘못 사용한 쿼리이다.

## ✅ `filter` vs `must`
`filter`와 `must`의 가장 큰 차이는 `filter`는 score(점수)에 영향을 주지 않고, `must`는 score(점수)에 영향을 준다는 점이다.
score(점수)가 활용되는 대표적인 쿼리가 `must`이다. score(점수)를 활용해 관련도가 높은 도큐먼트를 우선적으로 조회해온다.
즉, 정확하게 일치하지 않아도 도큐먼트를 조회해온다. 반면 `term` 쿼리와 같이 조건을 정확하게 일치시키지 않으면 도큐먼트를 아예 조회해오지 않는다.
이 때문에 score(점수)를 사용하지 않는다.

`filter`와 `must`의 사용도는 score(점수)에 영향을 주는 쿼리인지 아닌지로 구분해서 사용해야 한다.
* `filter`: score(점수)와 상관없는 쿼리인 경우 -> ex) `term`
* `must`: score(점수)와 상관있는 쿼리인 경우 -> ex) `match`

## ✅ `filter`와 `must`를 쉽게 구분하기
score(점수)를 활용하는 쿼리는 `text` 타입을 기반으로 검색을 유연하게 해주는 쿼리 밖에 없다.
즉, 정확하게 일치하지 않더라도 관련성이 있는 데이터까지 조회하는 쿼리에 대해서만 `must`를 사용하면 된다. 그 외에 전부 `filter`를 쓰면 된다.

* 유연한 검색 필요
  * `text`타입, `match`쿼리
  * `bool`의 `must`
* 정확한 검색 필요(정확한 값 비교)
  * `text` 이외의 타입, `term` 쿼리
  * `bool`의 `filter`